<!DOCTYPE>
<html>
<head>
  <style>
    body{
      font-family: Arial;
    }
    .funccall{
      font-family: monospace;
    }
    div input, div button{
      font-family: inherit;
      font-size: inherit;
      text-align: center;
      padding: 0.3em;
    }
    #name{
      width: 7em;
    }
    #argument{
      width: 20em;
    }
  </style>
</head>
<body>
  <div style="text-align: center; margin-top: 4em; font-size: 2em">
    <p style="font-weight: bold">Tell your device what to do!</p>
    <p class="funccall"><input type="text" id="name" value="servo">("<input type="text" id="argument" value="{&quot;position&quot;: 1}">")</p>
    <p><button id="execute">Execute</button></p>
    <p><button id="record">Start Recording</button></p>
  </div>
  <script src="https://cdn.jsdelivr.net/binaryjs/0.2.1/binary.min.js"></script>
  <script src="static/recorder.js"></script>
  <script src="https://code.jquery.com/jquery-3.1.1.min.js"
    integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
    crossorigin="anonymous"></script>
  <script src="https://cdn.WebRTC-Experiment.com/RecordRTC.js"></script>
  <script>
    var isRecording = false;
    $('#record').click(function(){
      if(!isRecording){
        startRecording();
        isRecording = true;
        $(this).text('Stop Recording');
      }else{
        stopRecording();
        isRecording = false;
        $(this).text('Start Recording');
      }
    });
    
    $('#execute').click(function(){
      callPhoton($('#name').val(), $('#argument').val());
    });
    $('#name, #argument').keypress(function(e){
      if(e.which == 13)
        callPhoton($('#name').val(), $('#argument').val());
    });
    
    $('window').keypress(function(e){
      if(e.which == 32)
        $('#record').focus().click();
    });
    
    function callPhoton(name, argument){
      $.post('/toast/'+name, {args: argument})
      .done(function(res){console.log(res);})
      .fail(function(xhr, ajaxOptions, thrownError){
        alert("Error " + xhr.status + ":\n" + thrownError);
      });
    }
  </script>
</body>
</html>
